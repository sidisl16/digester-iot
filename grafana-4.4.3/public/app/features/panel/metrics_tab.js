/*! grafana - v4.4.3 - 2017-08-07
 * Copyright (c) 2017 Torkel Ã–degaard; Licensed Apache-2.0 */

System.register([],function(a,b){"use strict";function c(){return{restrict:"E",scope:!0,templateUrl:"public/app/features/panel/partials/metrics_tab.html",controller:d}}b&&b.id;a("metricsTabDirective",c);var d;return{setters:[],execute:function(){d=function(){function a(a,b,c){this.uiSegmentSrv=b,this.datasourceSrv=c,this.panelCtrl=a.ctrl,a.ctrl=this,this.panel=this.panelCtrl.panel,this.dashboard=this.panelCtrl.dashboard,this.datasources=c.getMetricSources(),this.panelDsValue=this.panelCtrl.panel.datasource||null;for(var d=0,e=this.datasources;d<e.length;d++){var f=e[d];f.value===this.panelDsValue&&(this.current=f)}this.addQueryDropdown={text:"Add Query",value:null,fake:!0},this.panelCtrl.nextRefId=this.dashboard.getNextQueryLetter(this.panel)}return a.$inject=["$scope","uiSegmentSrv","datasourceSrv"],a.prototype.getOptions=function(a){return Promise.resolve(this.datasources.filter(function(b){return a||!b.meta.builtIn}).map(function(a){return{value:a.value,text:a.name,datasource:a}}))},a.prototype.datasourceChanged=function(a){a&&(this.current=a.datasource,this.panelCtrl.setDatasource(a.datasource))},a.prototype.addMixedQuery=function(a){if(a){this.panelCtrl.addQuery({isNew:!0,datasource:a.datasource.name}),this.addQueryDropdown={text:"Add Query",value:null,fake:!0}}},a.prototype.addQuery=function(){this.panelCtrl.addQuery({isNew:!0})},a}(),a("MetricsTabCtrl",d)}}});